# 原理
`dubhe`本质十分简单，流程如下:

## 对于js模块
1. 生产端正常打包，并将共有依赖给`external`，
2. 消费端在开发时，获得这些模块缓存在本地，并创建虚拟模块指向缓存，同样远程获得类型，此时体验与`npm`包无异。
3. 当生产端开启`watch`模式打包，消费端会及时更新缓存。
4. 当消费端打包时，如果是冷模式，就会正常将其打包，如果是热模式，将会把这些虚拟模块`external`掉，最后通过`importmap`/`systemjs`注入共有依赖的`cdn`。


## 静态资源
`dubhe`关于图片等资源的处理，可以是以`base64`可以是路径，这取决于打包器中的配置，但这里的路径是指生产端放置资源的位置(`url`)，如果生产端资源放在内网，使用冷模式打包，其他东西都没有影响，但图片指向的地址在内网，自然获取不到。


### css
关于`css`的处理可能具备潜在问题，现在是默认将`css`全部转成`js`,也就是把样式全转成文本，然后创建一个`style`标签往`head`里面挂。所以目前`dubhe`只支持`web`平台，后续会考虑其他

> 这里或许不一定是个好的处理，内部的版本之前采用的仍是保留正常`css`，但这让调试/维护/热更新变得异常玄幻。
> 现在生产端，只会生产出`js`和静态资源，无`css`。